<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Soulink ¬∑ Soul Chart</title>
<style>
  :root{
    --bg:#003c43; --fg:#eaf8f6; --muted:#bde5df; --accent:#00fdd8;
    --card:#014a52; --border:rgba(0,253,216,.35);
    --shadow:0 0 0 1px var(--border), 0 10px 30px rgba(0,253,216,.06), 0 0 40px rgba(0,253,216,.04) inset;
    --maxw:1100px;
  }
  *{box-sizing:border-box}
  body{margin:0;background:var(--bg);color:var(--fg);font:16px/1.6 system-ui,-apple-system,"Segoe UI",Roboto,Ubuntu,Arial,sans-serif}
  a{color:var(--accent);text-decoration:none}
  .container{max-width:var(--maxw);margin:0 auto;padding:24px}

  /* NAVBAR (tas pats vibe kaip My Soul) */
  .navbar{position:sticky;top:0;z-index:50;background:rgba(0,60,67,.85);backdrop-filter:blur(8px);border-bottom:1px solid var(--border)}
  .navbar::after{content:"";position:absolute;left:0;right:0;bottom:0;height:2px;background:linear-gradient(90deg,transparent,var(--accent),transparent);opacity:0;transform:scaleX(.2);transition:.25s}
  .navbar.scrolled::after{opacity:.85;transform:scaleX(1)}
  .nav-inner{display:flex;justify-content:space-between;align-items:center;padding:10px 16px}
  .brand{font-weight:800;color:var(--accent)}
  .nav-links{display:flex;gap:14px;flex-wrap:wrap}
  .nav-links a{padding:8px 10px;border-radius:10px;border:1px solid transparent;transition:box-shadow .15s,border-color .15s}
  .nav-links a:hover{border-color:var(--border);box-shadow:0 0 0 1px var(--border),0 0 16px rgba(0,253,216,.18)}
  .hamburger{display:none}
  .hamburger button{appearance:none;background:transparent;border:1px solid var(--border);color:var(--fg);padding:8px 10px;border-radius:10px;cursor:pointer}
  @media(max-width:800px){.nav-links{display:none}.hamburger{display:block}}

  /* DRAWER */
  .drawer{position:fixed;inset:0;display:none;z-index:100}
  .drawer.open{display:block}
  .drawer .backdrop{position:absolute;inset:0;background:rgba(0,60,67,.96)}
  .drawer .panel{position:absolute;top:0;right:0;width:min(82vw,360px);height:100%;background:#003c43;border-left:1px solid var(--border);padding:18px;transform:translateX(100%);transition:transform .25s ease}
  .drawer.open .panel{transform:translateX(0)}
  @media(prefers-reduced-motion:reduce){.drawer .panel{transition:none}}
  body.no-scroll{overflow:hidden}
  .drawer .panel a{display:block;padding:14px 12px;border-radius:12px;min-height:44px;transition:box-shadow .15s,background .15s}
  .drawer .panel a:hover{background:rgba(0,253,216,.08);box-shadow:0 0 0 1px var(--border),0 0 14px rgba(0,253,216,.18)}

  /* CARDS + GLOW */
  .card{position:relative;background:linear-gradient(180deg,rgba(1,74,82,.74),rgba(1,74,82,.56));border:1px solid var(--border);box-shadow:var(--shadow);border-radius:18px;padding:18px;margin:22px 0;overflow:hidden}
  .glow-card::after{
    content:"";position:absolute;inset:-1px;border-radius:18px;box-shadow:0 0 24px rgba(0,253,216,.25),0 0 48px rgba(0,253,216,.15);
    pointer-events:none;opacity:.0;transition:opacity .6s ease;
  }
  .glow-card:hover::after{opacity:.9}
  .stars{position:absolute;inset:0;z-index:0;pointer-events:none;opacity:.9}
  .card-inner{position:relative;z-index:1}

  .card h3{margin:0 0 6px 0}
  .sub{color:var(--muted);margin:0 0 12px 0;font-size:.95rem}
  .insight{color:var(--muted);margin:10px 0 0 0}

  /* Intro + empty state */
  .intro{margin-top:6px;color:var(--muted)}
  .empty{padding:18px;border:1px dashed var(--border);border-radius:14px;color:var(--muted);text-align:center}

  /* Buttons row */
  .actions{display:flex;gap:12px;flex-wrap:wrap;justify-content:flex-end;margin-top:10px}
  .btn{appearance:none;border:none;padding:10px 14px;border-radius:12px;cursor:pointer;font-weight:700;min-height:44px}
  .btn.primary{background:var(--accent);color:#003136}
  .btn.ghost{background:transparent;color:var(--fg);border:1px solid var(--border)}
  .btn:focus-visible{outline:2px solid var(--accent);outline-offset:2px}

  /* Animations */
  @keyframes chartFadeIn { from{opacity:0; transform:translateY(8px)} to{opacity:1; transform:none} }
  .chart-enter{opacity:0; animation:chartFadeIn .9s ease forwards}
  @media(prefers-reduced-motion:reduce){ .glow-card::after{display:none} .chart-enter{animation:none;opacity:1;transform:none} }

  /* Tooltip */
  .tooltip{position:fixed;z-index:9999;background:#012f34;color:var(--fg);border:1px solid var(--border);padding:6px 8px;border-radius:8px;font-size:.9rem;box-shadow:0 10px 30px rgba(0,0,0,.25);opacity:0;transform:translateY(4px);transition:.15s}
  .tooltip.show{opacity:1;transform:none}

  footer{margin:36px 0 16px;padding-top:16px;border-top:1px solid var(--border);color:var(--muted);font-size:.95rem;display:flex;justify-content:space-between;gap:12px;flex-wrap:wrap}

  @media (max-width:760px){ .actions{justify-content:flex-start} }

  /* Chart sizing */
.chart-card canvas,
.chart-canvas {
  width: 100% !important;
  height: clamp(260px, 48vh, 520px) !important; /* nedideli, bet erdv≈´s */
  display: block;
}

@media (max-width: 768px) {
  .chart-card canvas,
  .chart-canvas {
    height: clamp(220px, 42vh, 420px) !important;
  }
}

/* Pager at the bottom */
.pager {
  display:flex;
  justify-content:space-between;
  align-items:center;
  gap:12px;
  margin:24px 0 8px;
}
.pager .btn {
  appearance:none;border:1px solid var(--border);
  background:transparent;color:var(--fg);
  padding:10px 14px;border-radius:12px;min-height:44px;font-weight:700;
}
.pager .btn.primary {
  background:var(--accent); color:#003136; border-color:transparent;
}
</style>
</head>
<body>
  <!-- NAVBAR -->
  <nav class="navbar" role="navigation" aria-label="Main">
    <div class="nav-inner">
      <div class="brand">Soulink</div>
      <div class="nav-links" aria-label="Primary">
        <a href="index.html">Home</a>
        <a href="quiz.html">Quiz</a>
        <a href="edit-profile.html">Edit Profile</a>
        <a href="my-soul.html">My Soul</a>
        <a href="soul-chart.html" aria-current="page">Soul Chart</a>
        <a href="soul-coach.html">Soul Coach</a>
        <a href="match.html">Match</a>
        <a href="friends.html">Friends</a>
        <a href="results.html">Results</a>
        <a href="login.html">Log In</a>
        <a href="signup.html">Sign Up</a>
        <a href="#" id="logoutLink">Log Out</a>
      </div>
      <div class="hamburger"><button id="openDrawer" aria-label="Open menu">‚ò∞ Menu</button></div>
    </div>
  </nav>

  <!-- MOBILE DRAWER -->
  <div class="drawer" id="drawer" aria-hidden="true">
    <div class="backdrop" id="drawerBackdrop" tabindex="-1" aria-label="Close"></div>
    <aside class="panel" role="dialog" aria-modal="true" aria-label="Navigation">
      <a href="index.html">Home</a>
      <a href="quiz.html">Quiz</a>
      <a href="edit-profile.html">Edit Profile</a>
      <a href="my-soul.html">My Soul</a>
      <a href="soul-chart.html" aria-current="page">Soul Chart</a>
      <a href="soul-coach.html">Soul Coach</a>
      <a href="match.html">Match</a>
      <a href="friends.html">Friends</a>
      <a href="result.htsml">Results</a>
      <a href="login.html">Log In</a>
      <a href="signup.html">Sign Up</a>
      <a href="#" id="logoutLinkMobile">Log Out</a>
      <button class="btn ghost" id="closeDrawer" style="margin-top:8px">Close</button>
    </aside>
  </div>

  <div class="container">
    <h1 style="margin:6px 0 0 0">Soul Chart</h1>
    <p class="intro" id="introCopy">
      Your Soul Chart reveals the harmony between your heart‚Äôs language, your values, and the ways you refuel your spirit.
      Explore the shapes‚Äîhover or tap to see what each facet means.
    </p>
    <div id="emptyState" class="empty" hidden>
      Add your profile details to unlock your Soul Chart ‚ú®
    </div>

    <!-- LOVE LANGUAGES -->
    <section class="card glow-card">
      <canvas class="stars" aria-hidden="true"></canvas>
      <div class="card-inner">
        <h3>‚ú® The Voice of Your Heart</h3>
        <p class="sub">Primary love language is highlighted‚Äîhow you most naturally give and receive love.</p>
        <div class="chart-enter"><canvas id="loveChart" height="260" aria-label="Love language balance"></canvas></div>
        <p class="insight" id="loveInsight"></p>
      </div>
    </section>

    <!-- HOBBIES -->
    <section class="card glow-card">
      <canvas class="stars" aria-hidden="true"></canvas>
      <div class="card-inner">
        <h3>üåø Where Your Spirit Flows</h3>
        <p class="sub">Distribution of your favorite rituals and joys.</p>
        <div class="chart-enter"><canvas id="hobbyChart" height="260" aria-label="Hobbies mix"></canvas></div>
        <p class="insight" id="hobbyInsight"></p>
      </div>
    </section>

    <!-- VALUES -->
    <section class="card glow-card">
      <canvas class="stars" aria-hidden="true"></canvas>
      <div class="card-inner">
        <h3>üåå The Compass of Your Soul</h3>
        <p class="sub">A Heart‚ÄìMind‚ÄìSpirit balance derived from chosen values.</p>
        <div class="chart-enter"><canvas id="valuesChart" height="260" aria-label="Values compass"></canvas></div>
        <p class="insight" id="valuesInsight"></p>
      </div>
    </section>

    <div class="actions">
      <button class="btn ghost" id="refreshBtn">Refresh</button>
      <button class="btn primary" id="exportBtn">Export PNG</button>
    </div>

    <nav class="pager">
     <a class="btn" href="my-soul.html">‚Üê Back: My Soul</a>
     <a class="btn primary" href="soul-coach.html">Next ‚Üí Soul Coach</a>
    </nav>

    <footer>
      <span>¬© 2025 Soulink.global | Created with love by Soulink Team</span>
    </footer>
  </div>

  <!-- Chart.js CDN -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>

  <script>
  (function(){
    const $=s=>document.querySelector(s);
    const $$=s=>Array.from(document.querySelectorAll(s));
    const reduce = window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches;

    /* NAV + drawer */
    const navbar=document.querySelector('.navbar');
    const onScroll=()=> navbar?.classList[scrollY>6?'add':'remove']('scrolled');
    onScroll(); addEventListener('scroll', onScroll, {passive:true});
    $('#openDrawer')?.addEventListener('click',()=>{ $('#drawer').classList.add('open'); document.body.classList.add('no-scroll'); });
    $('#closeDrawer')?.addEventListener('click',()=>{ $('#drawer').classList.remove('open'); document.body.classList.remove('no-scroll'); });
    $('#drawerBackdrop')?.addEventListener('click',()=>{ $('#drawer').classList.remove('open'); document.body.classList.remove('no-scroll'); });
    $('#logoutLink')?.addEventListener('click', e=>{ e.preventDefault(); localStorage.clear(); location.href='index.html'; });
    $('#logoutLinkMobile')?.addEventListener('click', e=>{ e.preventDefault(); localStorage.clear(); location.href='index.html'; });
    addEventListener('keydown', e=>{ if(e.key==='Escape') $('#closeDrawer')?.click(); });

    /* Stars background (per card) */
    function makeStars(canvas){
      if(!canvas || reduce) return;
      const DPR = devicePixelRatio||1, ctx=canvas.getContext('2d');
      function resize(){ canvas.width=canvas.clientWidth*DPR; canvas.height=canvas.clientHeight*DPR; }
      resize(); addEventListener('resize', resize);
      const N = canvas.clientWidth<560 ? 18 : 36;
      const stars = Array.from({length:N},()=>({x:Math.random()*canvas.width,y:Math.random()*canvas.height,r:(Math.random()*1.2+0.6)*DPR,a:Math.random()*1}));
      (function tick(){
        ctx.clearRect(0,0,canvas.width,canvas.height);
        for(const s of stars){
          s.a += 0.02 + Math.random()*0.015;
          const f=(Math.sin(s.a)+1)/2;
          ctx.beginPath(); ctx.fillStyle=`rgba(0,253,216,${0.12+0.28*f})`;
          ctx.arc(s.x,s.y,s.r,0,Math.PI*2); ctx.fill();
        }
        if(!reduce) requestAnimationFrame(tick);
      })();
    }
    $$('.stars').forEach(makeStars);

    /* Data */
    function quiz(){ try{ return JSON.parse(localStorage.getItem('soulQuiz')||'{}'); }catch{ return {}; } }
    function list(v){ if(Array.isArray(v)) return v; if(typeof v==='string') return v.split(/[,\\n]/).map(s=>s.trim()).filter(Boolean); return []; }
    function nameOf(){ const d=quiz(); return d.name || 'You'; }

    /* LOVE LANG radar data */
    const LLABELS=['Words of Affirmation','Acts of Service','Receiving Gifts','Quality Time','Physical Touch'];
    function loveData(){
      const d=quiz(); const selected=list(d.loveLanguages||d.loveLanguage);
      const vals=LLABELS.map(l=>{
        if(!selected.length) return 0;
        if(selected[0]===l) return 5;
        if(selected.includes(l)) return 4;
        return 1;
      });
      return {labels:LLABELS, data:vals, primary:selected[0]||null, second: selected[1]||null};
    }

    /* HOBBIES donut data (top up to 8, rest = 'More') */
    function hobbyData(){
      const arr=list(quiz().hobbies);
      if(!arr.length) return {labels:[], data:[]};
      const counts={}; arr.forEach(h=>{ const k=h.trim(); counts[k]=(counts[k]||0)+1; });
      const entries=Object.entries(counts).sort((a,b)=>b[1]-a[1]);
      const top=entries.slice(0,8), rest=entries.slice(8);
      const labels=top.map(e=>e[0]); const data=top.map(e=>e[1]);
      if(rest.length){ labels.push('More'); data.push(rest.reduce((s,e)=>s+e[1],0)); }
      return {labels,data,total:arr.length};
    }

    /* VALUES -> Heart/Mind/Spirit */
    const VMAP={
      Heart:['Compassion','Kindness','Empathy','Love','Honesty','Loyalty','Respect','Gratitude'],
      Mind:['Integrity','Curiosity','Wisdom','Discipline','Growth','Balance','Responsibility','Ambition'],
      Spirit:['Freedom','Creativity','Adventure','Spirituality','Peace','Presence','Courage','Faith']
    };
    function valuesData(){
      const arr=list(quiz().values);
      let heart=0,mind=0,spirit=0;
      arr.forEach(v=>{
        if(VMAP.Heart.includes(v)) heart++;
        else if(VMAP.Mind.includes(v)) mind++;
        else if(VMAP.Spirit.includes(v)) spirit++;
        else { /* unknowns -> distribute lightly */ mind+=0.5; }
      });
      const max=Math.max(heart,mind,spirit,1);
      const norm = x=> Math.round((x/max)*100);
      return {labels:['Heart','Mind','Spirit'], data:[norm(heart),norm(mind),norm(spirit)]};
    }

    /* Charts */
    let loveChart,hobbyChart,valuesChart;

    // Glow plugin (no manual draw calls)
    const glowPlugin = {
      id:'soulinkGlow',
      beforeDatasetsDraw(chart,args,opts){
        const ctx=chart.ctx; ctx.save();
        ctx.shadowColor = 'rgba(0,253,216,.45)';
        ctx.shadowBlur = 18;
      },
      afterDatasetsDraw(chart,args,opts){
        chart.ctx.restore();
      }
    };

    function mkLove(){
      const el=$('#loveChart'); if(!el) return;
      const L=loveData();
      loveChart && loveChart.destroy();
      loveChart = new Chart(el, {
        type:'radar',
        data:{
          labels:L.labels,
          datasets:[{
            label:'Love',
            data:L.data,
            fill:true,
            backgroundColor:'rgba(0,253,216,.12)',
            borderColor:'#00fdd8',
            pointBackgroundColor:'#00fdd8',
            pointBorderColor:'#003c43',
            pointRadius:3
          }]
        },
        options:{
          responsive:true,
          maintainAspectRatio: false,
          animation: reduce ? false : {duration:1400, easing:'easeOutQuad'},
          scales:{ r:{
            angleLines:{ color:'rgba(255,255,255,.15)' },
            grid:{ color:'rgba(255,255,255,.12)' },
            pointLabels:{ color:'#eaf8f6', font:{size:12} },
            suggestedMin:0, suggestedMax:5, ticks:{showLabelBackdrop:false, color:'#bde5df', stepSize:1}
          }},
          plugins:{
            tooltip:{
              callbacks:{
                label:ctx=>{
                  const lab=ctx.label, v=ctx.raw;
                  const star = (loveData().primary===lab)?' ‚òÖ':'';
                  return `${lab}${star} ‚Äî ${v}/5`;
                }
              }
            },
            legend:{display:false}
          }
        },
        plugins:[glowPlugin]
      });
      // insight
      const pri = L.primary, sec = L.second;
      $('#loveInsight').textContent = pri ? `Your love leads with ${pri}${sec?`, harmonized with ${sec}`:''}.` : 'No data yet.';
    }

    function mkHobby(){
      const el=$('#hobbyChart'); if(!el) return;
      const H=hobbyData();
      hobbyChart && hobbyChart.destroy();
      hobbyChart = new Chart(el, {
        type:'doughnut',
        data:{
          labels:H.labels,
          datasets:[{
            data:H.data,
            backgroundColor:H.labels.map((_,i)=>`hsla(${170+i*22}, 90%, 55%, .28)`),
            borderColor:'#00fdd8',
            borderWidth:1
          }]
        },
        options:{
          responsive:true,
          maintainAspectRatio: false,
          cutout:'55%',
          animation: reduce ? false : {duration:1400,easing:'easeOutQuad'},
          plugins:{
            tooltip:{
              callbacks:{
                label:ctx=>{
                  const val=ctx.raw, sum=ctx.dataset.data.reduce((a,b)=>a+b,0)||1;
                  const pct=Math.round((val/sum)*100);
                  return `${ctx.label} ‚Äî ${pct}%`;
                }
              }
            },
            legend:{display:false}
          }
        },
        plugins:[glowPlugin]
      });
      // insight
      $('#hobbyInsight').textContent = H.labels.length ? `Your soul balances across what you enjoy most ‚Äî let these small joys refuel your light.` : 'No data yet.';
    }

    function mkValues(){
      const el=$('#valuesChart'); if(!el) return;
      const V=valuesData();
      valuesChart && valuesChart.destroy();
      valuesChart = new Chart(el, {
        type:'radar',
        data:{
          labels:V.labels,
          datasets:[{
            label:'Values',
            data:V.data,
            fill:true,
            backgroundColor:'rgba(0,253,216,.10)',
            borderColor:'#00fdd8',
            pointBackgroundColor:'#00fdd8',
            pointBorderColor:'#003c43',
            pointRadius:3
          }]
        },
        options:{
          responsive:true,
          maintainAspectRatio: false,
          animation: reduce ? false : {duration:1400, easing:'easeOutQuad'},
          scales:{ r:{
            angleLines:{ color:'rgba(255,255,255,.15)' },
            grid:{ color:'rgba(255,255,255,.12)' },
            pointLabels:{ color:'#eaf8f6', font:{size:12} },
            suggestedMin:0, suggestedMax:100, ticks:{showLabelBackdrop:false, color:'#bde5df', stepSize:20}
          }},
          plugins:{
            tooltip:{
              callbacks:{ label:ctx=>`${ctx.label} ‚Äî ${ctx.raw}%` }
            },
            legend:{display:false}
          }
        },
        plugins:[glowPlugin]
      });
      // insight
      const maxIdx = V.data.indexOf(Math.max(...V.data));
      const axis = V.labels[maxIdx] || 'Heart';
      $('#valuesInsight').textContent = V.labels.length ? `Your strongest compass leans to ${axis}.` : 'No data yet.';
    }

    /* Intersection to trigger entry + ensure stars start */
    const io = new IntersectionObserver((entries)=>{
      entries.forEach(e=>{
        if(e.isIntersecting){
          e.target.classList.add('chart-enter');
          io.unobserve(e.target);
        }
      });
    }, {threshold:.3});
    $$('.chart-enter').forEach(el=> io.observe(el));

    /* Intro / empty state */
    function updateIntro(){
      const d=quiz();
      const has = (list(d.loveLanguages).length + list(d.hobbies).length + list(d.values).length) > 0;
      $('#emptyState').hidden = has;
      $('#introCopy').hidden = !has;
    }

    /* Toast */
    function toast(msg){
      let n=$('#toast'); if(!n){ n=document.createElement('div'); n.id='toast';
        n.style.cssText='position:fixed;bottom:18px;left:50%;transform:translateX(-50%);padding:10px 14px;border-radius:10px;background:#0a3;box-shadow:0 8px 30px rgba(0,0,0,.25);color:#fff;z-index:9999;opacity:0;transition:.2s'; document.body.appendChild(n); }
      n.textContent=msg; n.style.opacity='1'; setTimeout(()=> n.style.opacity='0', 1200);
    }

    /* Export combined PNG */
    function exportPNG(){
      const name = (quiz().name||'soul').toLowerCase().replace(/\s+/g,'-');
      const loveCan = $('#loveChart'), hobCan=$('#hobbyChart'), valCan=$('#valuesChart');
      const W=1400,H=900, pad=52, DPR=Math.max(2, Math.floor(devicePixelRatio||2));
      const cvs=document.createElement('canvas'); cvs.width=W*DPR; cvs.height=H*DPR;
      const ctx=cvs.getContext('2d'); ctx.scale(DPR,DPR);

      // bg gradient + stars
      const g=ctx.createLinearGradient(0,0,0,H); g.addColorStop(0,'#022e33'); g.addColorStop(1,'#053c42'); ctx.fillStyle=g; ctx.fillRect(0,0,W,H);
      for(let i=0;i<90;i++){ const x=Math.random()*W, y=Math.random()*H, r=Math.random()*1.3+0.4, a=0.12+Math.random()*0.25;
        ctx.beginPath(); ctx.fillStyle=`rgba(0,253,216,${a})`; ctx.arc(x,y,r,0,Math.PI*2); ctx.fill(); }

      // header
      ctx.fillStyle='#00fdd8'; ctx.font='800 40px system-ui'; ctx.fillText('Soulink ¬∑ Soul Chart', pad, 70);
      ctx.strokeStyle='rgba(0,253,216,.6)'; ctx.lineWidth=2; ctx.shadowColor='rgba(0,253,216,.7)'; ctx.shadowBlur=12;
      ctx.beginPath(); ctx.moveTo(pad,88); ctx.lineTo(W-pad,88); ctx.stroke(); ctx.shadowBlur=0;

      // place canvases
      function drawScaled(src, x,y, w,h){
        try{ ctx.drawImage(src, x,y,w,h); }catch(e){}
      }
      const cw=(W-pad*3)/2, ch=(H-160-pad*2)/2;
      drawScaled(loveCan, pad, 120, cw, ch);
      drawScaled(hobCan, pad+cw+pad, 120, cw, ch);
      drawScaled(valCan, pad, 120+ch+pad, cw, ch);

      // labels
      ctx.fillStyle='#eaf8f6'; ctx.font='700 18px system-ui';
      ctx.fillText('The Voice of Your Heart', pad, 110);
      ctx.fillText('Where Your Spirit Flows', pad+cw+pad, 110);
      ctx.fillText('The Compass of Your Soul', pad, 110+ch+pad);

      // download
      const a=document.createElement('a');
      a.href=cvs.toDataURL('image/png',1.0);
      a.download=`soul-chart-${name||'you'}.png`;
      a.click();
    }

    /* Build all */
    function build(){
      updateIntro();
      mkLove(); mkHobby(); mkValues();
    }

    $('#refreshBtn')?.addEventListener('click', ()=>{ build(); toast('Chart updated ‚ú®'); });
    $('#exportBtn')?.addEventListener('click', (e)=>{ e.preventDefault(); exportPNG(); });

    document.addEventListener('DOMContentLoaded', build);
  })();
  </script>
</body>
</html>
